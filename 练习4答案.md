# 假设一个Hypervisor中运行有4个Guest VM，每个Guest VM中运行有10个应用（需要10个Guest页表），请在用影子分页方式实现内存虚拟化时，Hypervisor共需维护多少份影子页表？

**Hypervisor共需维护44份影子页表**，Guest系统中需要初始化进程和空闲循环共1个页表，10个应用需要10个页表，一个Guest VM需要维护11份页表



# 假设在Guest OS中实现了4级页表，Guest的一次访存（使用Guest虚拟地址）会导致多少次内存访问？（使用4级页表实现内存虚拟化；假设TLB全部失效；假设不出现缺页或EPT违规）

25次，每次ept查询时都会被拦截到Hypervisor中变成物理地址，可能经历5次缺页，四级总共要访问5次，所以答案为5*5=25次



# 简而言之：如果要修改分配内存，应该在代码上做哪些修改？

更改违规处理，例如缺页等情况能够自动分配给其内存，同时这也可以用于实现写时分配

